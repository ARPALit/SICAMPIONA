@*
  Nome del progetto: SICampiona
  Copyright (C) 2025 Agenzia regionale per la protezione dell'ambiente ligure

  Questo programma è software libero: puoi ridistribuirlo e/o modificarlo
  secondo i termini della GNU Affero General Public License pubblicata dalla
  Free Software Foundation, sia la versione 3 della licenza, sia (a tua scelta)
  qualsiasi versione successiva.

  Questo programma è distribuito nella speranza che possa essere utile,
  ma SENZA ALCUNA GARANZIA; senza nemmeno la garanzia implicita di
  COMMERCIABILITÀ o IDONEITÀ PER UNO SCOPO PARTICOLARE. Vedi la
  GNU Affero General Public License per ulteriori dettagli.

  Dovresti aver ricevuto una copia della GNU Affero General Public License
  insieme a questo programma. In caso contrario, vedi <https://www.gnu.org/licenses/>.
*@

@page "/campionamento/{idCampionamento:int}"

@using SICampiona.Model
@using SICampiona.Pages.Visualizzazione
@using SICampiona.Services

@inject ICampionamentiStorage campionamentiStorage
@inject NavigationManager Navigation

@if (campionamento == null)
{
	<FluentLabel Typo="Typography.Body" Color="Color.Warning"> Campionamento non trovato </FluentLabel>
}
else
{
	@if (campionamento.DataOraChiusuraCampionamento != null || campionamento.Eliminato)
	{
		<VisualizzaCampionamento Campionamento="@campionamento" />
	}
	else
	{
		<ModificaCampionamento Campionamento="@campionamento" />
	}
}

@code {
	[Parameter]
	public int IdCampionamento { get; set; }

	public Campionamento campionamento;

	protected override async Task OnInitializedAsync()
	{
		var result = await campionamentiStorage.Dettagli(IdCampionamento);
		if (result.IsSuccess)
		{
			campionamento = result.Data;
		}
		else
		{
			campionamento = null;
		}
	}
}
